<app-header static />
@if(chapter) {
<div id="header" class="header">
	<div class="title">
		<h1>Capitulo {{ chapter.index | number }}</h1>
		@if(chapter.title){
		<h2>{{ chapter.title }}</h2>
		}
	</div>
	<div class="controler">
		@if(chapter.previous){
		<a class="arrow" (click)="previousPage()">
			<app-icons name="arrow-left" size="42" />
		</a>
		}
		<a class="index" (click)="backPage()">
			{{ chapter.index | number }}/{{ chapter.totalChapters }}
		</a>
		@if(chapter.next){
		<a class="arrow" (click)="nextPage()">
			<app-icons name="arrow-right" size="42" />
		</a>
		}
	</div>
</div>
<div
	class="pages"
	[style.filter]="filterStyle"
	[class.aside-left]="settings.asidePosition === 'left'"
	[class.aside-right]="settings.asidePosition === 'right'"
>
	<div class="reading-progress-bar">
		<div
			class="reading-progress-fill"
			[style.width.%]="readingProgress"
		></div>
	</div>
	@for (page of chapter.pages; track $index) {
	<div class="page-container">
		<img [src]="page.path" alt="Page Image" />
		@if(settings.showPageNumbers) {
		<span class="page-number">{{ $index + 1 }}</span>
		}
	</div>
	}@empty {
	<p>No pages available for this chapter.</p>
	}
	<div
		class="last-chapter shortcuts-mobile-pages"
		(dblclick)="previousPage()"
	>
		<div class="extension"></div>
	</div>
	<div class="next-chapter shortcuts-mobile-pages" (dblclick)="nextPage()">
		<div class="extension"></div>
	</div>
	<div
		class="btn-top"
		[ngClass]="{
			show: showBtnTop
		}"
		(click)="scrollToTop()"
	>
		<app-icons name="arrow-up" size="42" />
	</div>
</div>
<div class="footer">
	@if(this.chapter.next) {
	<a class="next" (click)="nextPage()">
		Proximo capitulo
		<app-icons name="arrow-right" size="42" />
	</a>
	} @else {
	<a class="next" (click)="backPage()">Voltar a pagina inicial</a>
	}
</div>
<app-aside [topOffset]="0" [position]="settings.asidePosition">
	<div class="title">
		<h1 (click)="backPage()">
			<app-icons name="book" /> {{ chapter.bookTitle }}
		</h1>
		<h1>
			<app-icons name="file" />
			{{ chapter.title || 'Capitulo ' + (chapter.index | number) }}
		</h1>
	</div>
	<div class="controler">
		@if(chapter.previous){
		<a class="arrow" (click)="previousPage()">
			<app-icons name="arrow-left" size="16" />
		</a>
		}
		<a class="index" (click)="backPage()">
			{{ chapter.index | number }}/{{ chapter.totalChapters }}
		</a>
		@if(chapter.next){
		<a class="arrow" (click)="nextPage()">
			<app-icons name="arrow-right" size="16" />
		</a>
		}
	</div>
	<div class="button">
		<button
			class="settings-btn"
			(click)="openSettings()"
			title="Configurações"
			variant="text"
		>
			<app-icons name="settings" size="32" />
		</button>
	</div>
	@if(admin){
	<div class="line"></div>
	<div class="actions">
		<app-button (click)="resetChapter()" variant="text">
			Resetar capitulo
		</app-button>
		<app-button (click)="openOriginalLink()" variant="text">
			Link original
		</app-button>
	</div>
	}
</app-aside>
}
